# Redis

## 实践

- 点赞功能
  - 实现
    - MySQL维护点赞数量；
    - 使用Set维护点赞用户id，防止用户多次点赞；
    - Set一段时间(eg. 1month)过期；
  - 由于单个用户多次点赞的影响很小，因此即使数据过期也没关系；
- 文章热度排序功能
  - 实现
    - 将文章的热度(点击量/收藏量等)乘一个常量然后加上文章的发布时间作为文章的评分；
    - 使用zSet对文章进行排序
- 文章分组+组内热度排序功能
  - 实现
    - 将文章的热度(点击量/收藏量等)乘一个常量然后加上文章的发布时间作为文章的评分；
    - 使用zSet对文章进行排序
    - 使用Set对文章进行分组
    - 使用ZINTERSTORE合并zSet和Set，获得文章分组后的热度排序的zSet
    - 将计算结果存入Redis中，一段时间过期(eg. 60s)，下次获取时再计算
- 按标签推荐功能
  - 实现
    - 存放每个标签的文章id的Set
    - 将查询用户的标签对应的Set取并集并缓存，然后使用ZINTERSTORE合并zSet和Set，即生成推荐列表
- 按位置推荐功能
  - 实现
    - MySQL存放每个文章的发布的经纬度
    - 用geo距离算法，根据经纬度做二分搜索，计算出某个区间的hash值，Redis缓存某个区间的查询结果